@startuml
title DSM - FairRideApp Security Domain

' === LEGEND (stereotypes) ===
' <<Asset>>, <<Requirement>>, <<Property>>, <<Threat>>, <<Attack>>, <<Solution>>

package "FairRideApp_Domain" {

  ' --- ASSETS ---
  class UserData <<Asset>> {
    + profile
    + trip_history
    + payment_tokens
  }

  class Database <<Asset>> {
    + trips_table
    + users_table
    + pricing_rules
  }

  class APIGateway <<Asset>> {
    + /auth
    + /trips/quote
    + /trips/book
  }

  class LogSystem <<Asset>> {
    + security_log
    + audit_log
  }

  ' --- SECURITY REQUIREMENTS ---
  class R1_DataProtection_Privacy <<Requirement>> {
    R1: Data protection & privacy
  }

  class R3_FairPricingValidation <<Requirement>> {
    R3: Fair pricing validation
  }

  class R2_SecureAuthentication <<Requirement>> {
    R2: Secure authentication
  }

  class R4_Auditability_Transparency <<Requirement>> {
    R4: Auditability & transparency
  }

  ' --- SECURITY PROPERTIES ---
  class P_Confidentiality <<Property>>
  class P_Transparency <<Property>>
  class P_Integrity <<Property>>
  class P_Traceability_Availability <<Property>>

  ' --- THREATS ---
  class T_DataBreach <<Threat>>
  class T_UnauthorizedAccess <<Threat>>
  class T_PriceManipulation <<Threat>>
  class T_DoS <<Threat>>

  ' --- ATTACKS ---
  class A_Phishing <<Attack>>
  class A_MITM <<Attack>>
  class A_SQLInjection <<Attack>>
  class A_Flooding <<Attack>>

  ' --- SOLUTIONS / SECURITY PATTERNS ---
  class S_Encryption <<Solution>>
  class S_SecureProtocols <<Solution>>
  class S_InputValidation <<Solution>>
  class S_AuditLogsMonitoring <<Solution>>

}

' === RELATIONSHIPS ===

' Requirements -> Assets
R1_DataProtection_Privacy --> UserData : protects
R1_DataProtection_Privacy --> Database : protects
R2_SecureAuthentication --> APIGateway : protects
R3_FairPricingValidation --> Database : constrains
R4_Auditability_Transparency --> LogSystem : requires

' Requirements -> Properties
R1_DataProtection_Privacy --> P_Confidentiality
R2_SecureAuthentication --> P_Integrity
R3_FairPricingValidation --> P_Integrity
R4_Auditability_Transparency --> P_Transparency
R4_Auditability_Transparency --> P_Traceability_Availability

' Threats -> Assets
T_DataBreach --> UserData
T_DataBreach --> Database
T_UnauthorizedAccess --> APIGateway
T_PriceManipulation --> Database
T_DoS --> APIGateway
T_DoS --> LogSystem

' Attacks -> Threats
A_Phishing --> T_UnauthorizedAccess
A_MITM --> T_UnauthorizedAccess
A_SQLInjection --> T_DataBreach
A_SQLInjection --> T_PriceManipulation
A_Flooding --> T_DoS

' Solutions -> Properties
S_Encryption --> P_Confidentiality
S_SecureProtocols --> P_Integrity
S_InputValidation --> P_Integrity
S_AuditLogsMonitoring --> P_Transparency
S_AuditLogsMonitoring --> P_Traceability_Availability

' Solutions -> Attacks / Threats (mitigations)
S_Encryption ..> T_DataBreach : mitigates
S_SecureProtocols ..> T_UnauthorizedAccess : mitigates
S_InputValidation ..> T_PriceManipulation : mitigates
S_AuditLogsMonitoring ..> T_DoS : detects

@enduml
