@startuml
title STDD secure development cycle - FairRideApp

' === PARTITIONS (SWIMLANES) ===
partition "Lane 1 – System Developer" {

  start
  :Define function objective;
  :Define domain security knowledge;
  :Select one security pattern;

}

partition "Lane 2 – Security Engineer" {

  :Review Tropos and DSM models;
  :Export Secure Tropos model (PlantUML);
  :Export DSM model (PlantUML);

}

partition "Lane 3 – AI Assistant" {

  :Generate initial code (text-only prompt);
  :Generate improved secure code\n(with PlantUML and improved tests);

}

partition "Lane 4 – Testing & Analysis Tools" {

  :Generate initial tests (TDD);
  :Run automated unit tests;
  :Run static code analysis;
  :Run vulnerability scanning;

  if ("Vulnerabilities found?") then (yes)
    partition "Lane 1 – System Developer" {
      :Refine PlantUML models if needed;
    }

    partition "Lane 4 – Testing & Analysis Tools" {
      :Update test cases;
      :Integrate security mechanisms;
    }

    ' loop back to analysis tools
    -> "Run automated unit tests";
  else (no)
    partition "Lane 5 – Repository / CI Pipeline" {
      :Commit secure version to repository;
      :Tag release / deployment candidate;
    }
    stop
  endif
}

@enduml
