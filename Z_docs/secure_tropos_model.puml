@startuml
title Secure Tropos model - FairRideApp

' === ACTORS ===
actor "Passenger" as Passenger
actor "Driver" as Driver
actor "FairRide Platform" as Platform
actor "Payment Provider" as PaymentProvider
actor "Attacker" as Attacker

rectangle "FairRideApp Goals" {

  ' --- High level goals ---
  usecase "G1: Book fair trip" as G1
  usecase "G2: Pay securely" as G2
  usecase "G3: Keep user data private" as G3
  usecase "G4: Maintain service availability" as G4

  ' --- Security constraints / softgoals ---
  usecase "SC1: Data protection & privacy\n(R1)" as SC1
  usecase "SC2: Fair pricing validation\n(R3)" as SC2
  usecase "SC3: Secure authentication\n(R2)" as SC3
  usecase "SC4: Auditability & transparency\n(R4)" as SC4

}

' === DELEGATIONS / DEPENDENCIES ===
Passenger --> G1 : wants
Passenger --> G2 : wants
Passenger --> G3 : expects
Passenger --> G4 : expects

Driver --> G1 : participates in
Driver --> G4 : depends on

Platform --> G1 : operational responsibility
Platform --> G2
Platform --> G3
Platform --> G4

PaymentProvider --> G2 : processes payments

' Security constraints applied to platform goals
SC1 --> G3 : constrains
SC2 --> G1 : constrains
SC3 --> G1 : constrains
SC4 --> G1 : constrains

' === THREATS (MISUSE GOALS) ===
usecase "T1: Data breach" as T1
usecase "T2: Unauthorized access" as T2
usecase "T3: Price manipulation" as T3
usecase "T4: DoS on API / logs" as T4

Attacker --> T1
Attacker --> T2
Attacker --> T3
Attacker --> T4

T1 ..> G3 : threatens
T2 ..> G3 : threatens
T3 ..> G1 : threatens
T4 ..> G4 : threatens

' === COUNTERMEASURES (PATTERNS) ===
usecase "S1: Encryption" as S1
usecase "S2: Secure Protocols" as S2
usecase "S3: Input Validation" as S3
usecase "S4: Audit Logs & Monitoring" as S4

S1 ..> SC1 : operationalizes
S2 ..> SC1 : supports
S2 ..> SC3 : supports
S3 ..> SC2 : operationalizes
S4 ..> SC4 : operationalizes

' Countering threats
S1 ..|> T1 : mitigates
S2 ..|> T2 : mitigates
S3 ..|> T3 : mitigates
S4 ..|> T4 : mitigates

@enduml
